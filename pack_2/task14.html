<!DOCTYPE HTML>
<html>

    <head>
        <title>task no. 14</title>
        <meta charset="UTF-8">

        <link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,400i,700,700i%7cWork+Sans:400,500,700" rel="stylesheet" type="text/css">

    </head>

<body>


<p>Task no. 14</p>

<script>

    while(true)
    {
        let text = prompt("enter text");//= "this is some. random text this. this is great. qwe"


        let re_punct= /[,;:()]/;
        let double_len = Number(text.length) * 2;

        for (let i = 0;  i < double_len; i++ )
        {
            text = text.replace(re_punct, ' ');
        }

        let sentences = text.split( /[.!?]/);
        let n = sentences.length
        let sentences_map =new Array(n);

        for (var i=0; i<n; i++) {  //словари в массиве
            sentences_map[i] = new Map() 
        }
        
        for(let i =0; i< n; i++)  //запишем слова в словари
        {
            let tagList = sentences[i].split( /\s+/);
            for(key in tagList)
            {
                if(tagList[key] == "" || tagList[key] == " ")
                    continue;
                /*if (sentences_map[i].hasOwnProperty(tagList[key])) 
                {
                    let old_value = Number(sentences_map[i].get(tagList[key]));
                    old_value++;
                    alert(`${tagList[key]} + ' = ' + ${old_value}`);
                }                 
                else */
                sentences_map[i].set(tagList[key], 0)//[key] = 1;
            }
        }


        for(let i =0; i< n; i++)  //смотрим на то, сколько раз каждое слово повторяется в других предложениях
        {
            for(let j =0; j< n; j++)
            {
                if(i == j)   //не сверяем предложение с самим собой
                    continue;

                let tagList = sentences[j].split( /\s+/);
                for(key in tagList)
                {
                    if(tagList[key] == "" || tagList[key] == " ")
                        continue;
                    if (sentences_map[i].has(tagList[key])) 
                    {
                        let old_value = Number(sentences_map[i].get(tagList[key]));
                        old_value++;
                        sentences_map[i].set(tagList[key], old_value)
                    }                 
                }
            }
        }

        let result = new Array(n);
        let max = 0, max_index = 0;
        for(let i =0; i< n;i++){  //ищем предложение с наибольшим количеством повторений
            result[i] = 0; 
            for (var [key, value] of sentences_map[i]) 
            {
                result[i] += value;
            }
            if(result[i] > max)
            {
                max = result[i];
                max_index = i;
            }
        }


        /*for(let i =0; i< n;i++){
            for (var [key, value] of sentences_map[i]) {
                alert(`${i}:${key} + ' = ' + ${value}`);
            }
        }*/


        if(max == 0)
            alert("there is no repeating words in text")
        else
            alert(`most popular words in sentence: ${sentences[max_index]}\nthere are ${max} repeated words`)

    }

</script>

<p>Task is complete.</p>

</body>

</html>


